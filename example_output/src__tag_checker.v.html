<html>
  <head>
    <link rel="stylesheet" href="rtl_html_style.css">
  </head>
  <body>
    <p>File path: src/tag_checker.v</p>
    <hr>
    <pre class="code">
<code id="1">`timescale <span class="hljs-const">1</span>ns<span class="hljs-operator">/</span><span class="hljs-const">1</span>ps</code>
<code id="2"></code>
<code id="3"><span class="hljs-keyword">module</span> tag_checker <span class="hljs-operator">(</span></code>
<code id="4">    <span class="hljs-keyword">input</span>   <span class="hljs-keyword">wire</span>    <span class="hljs-operator">[</span><span class="hljs-const">TAG_BITS_WIDTH</span><span class="hljs-operator">-</span><span class="hljs-const">1</span><span class="hljs-operator">:</span><span class="hljs-const">0</span><span class="hljs-operator">]</span>        i_tag_bits<span class="hljs-operator">,</span></code>
<code id="5">    </code>
<code id="6">    <span class="hljs-keyword">input</span>   <span class="hljs-keyword">wire</span>    <span class="hljs-operator">[</span><span class="hljs-const">TAG_ARRAY_WIDTH</span><span class="hljs-operator">-</span><span class="hljs-const">1</span><span class="hljs-operator">:</span><span class="hljs-const">0</span><span class="hljs-operator">]</span>       i_ta_data<span class="hljs-operator">,</span></code>
<code id="7">    <span class="hljs-keyword">input</span>   <span class="hljs-keyword">wire</span>    <span class="hljs-operator">[</span><span class="hljs-const">STATUS_ARRAY_WIDTH</span><span class="hljs-operator">-</span><span class="hljs-const">1</span><span class="hljs-operator">:</span><span class="hljs-const">0</span><span class="hljs-operator">]</span>    i_status_array_data<span class="hljs-operator">,</span></code>
<code id="8">    </code>
<code id="9">    <span class="hljs-comment">// pass through for miss handling</span></code>
<code id="10">    <span class="hljs-keyword">input</span>   <span class="hljs-keyword">wire</span>    <span class="hljs-operator">[</span><span class="hljs-const">SET_BITS_WIDTH</span><span class="hljs-operator">-</span><span class="hljs-const">1</span><span class="hljs-operator">:</span><span class="hljs-const">0</span><span class="hljs-operator">]</span>        i_set_bits<span class="hljs-operator">,</span></code>
<code id="11">    <span class="hljs-keyword">input</span>   <span class="hljs-keyword">wire</span>    <span class="hljs-operator">[</span><span class="hljs-const">BLOCK_OFFSET_BITS</span><span class="hljs-operator">-</span><span class="hljs-const">1</span><span class="hljs-operator">:</span><span class="hljs-const">0</span><span class="hljs-operator">]</span>     i_block_offset_bits<span class="hljs-operator">,</span></code>
<code id="12">    <span class="hljs-keyword">input</span>   <span class="hljs-keyword">wire</span>                                i_valid<span class="hljs-operator">,</span></code>
<code id="13">    <span class="hljs-keyword">input</span>   <span class="hljs-keyword">wire</span>                                i_clear<span class="hljs-operator">,</span></code>
<code id="14">    </code>
<code id="15">    <span class="hljs-keyword">input</span>   <span class="hljs-keyword">wire</span>                                clk<span class="hljs-operator">,</span></code>
<code id="16">    <span class="hljs-keyword">input</span>   <span class="hljs-keyword">wire</span>                                arst_n<span class="hljs-operator">,</span></code>
<code id="17">    <span class="hljs-keyword">input</span>   <span class="hljs-keyword">wire</span>                                i_halt<span class="hljs-operator">,</span></code>
<code id="18">    </code>
<code id="19">    <span class="hljs-keyword">output</span>  <span class="hljs-keyword">wire</span>    <span class="hljs-operator">[</span><span class="hljs-const">NUM_BLOCKS</span><span class="hljs-operator">-</span><span class="hljs-const">1</span><span class="hljs-operator">:</span><span class="hljs-const">0</span><span class="hljs-operator">]</span>            o_hit_blocks<span class="hljs-operator">,</span></code>
<code id="20">    <span class="hljs-keyword">output</span>  <span class="hljs-keyword">reg</span>                                 o_cache_hit<span class="hljs-operator">,</span> <span class="hljs-comment">// 1 means cache hit, 0 means miss</span></code>
<code id="21">    <span class="hljs-keyword">output</span>  <span class="hljs-keyword">reg</span>     <span class="hljs-operator">[</span><span class="hljs-const">TAG_BITS_WIDTH</span><span class="hljs-operator">-</span><span class="hljs-const">1</span><span class="hljs-operator">:</span><span class="hljs-const">0</span><span class="hljs-operator">]</span>        o_tag_bits<span class="hljs-operator">,</span></code>
<code id="22">    <span class="hljs-keyword">output</span>  <span class="hljs-keyword">reg</span>     <span class="hljs-operator">[</span><span class="hljs-const">SET_BITS_WIDTH</span><span class="hljs-operator">-</span><span class="hljs-const">1</span><span class="hljs-operator">:</span><span class="hljs-const">0</span><span class="hljs-operator">]</span>        o_set_bits<span class="hljs-operator">,</span></code>
<code id="23">    <span class="hljs-keyword">output</span>  <span class="hljs-keyword">reg</span>     <span class="hljs-operator">[</span><span class="hljs-const">BLOCK_OFFSET_BITS</span><span class="hljs-operator">-</span><span class="hljs-const">1</span><span class="hljs-operator">:</span><span class="hljs-const">0</span><span class="hljs-operator">]</span>     o_block_offset_bits<span class="hljs-operator">,</span></code>
<code id="24">    <span class="hljs-keyword">output</span>  <span class="hljs-keyword">reg</span>     <span class="hljs-operator">[</span><span class="hljs-const">STATUS_ARRAY_WIDTH</span><span class="hljs-operator">-</span><span class="hljs-const">1</span><span class="hljs-operator">:</span><span class="hljs-const">0</span><span class="hljs-operator">]</span>    o_status_array_data<span class="hljs-operator">,</span> </code>
<code id="25"></code>
<code id="26">    <span class="hljs-keyword">output</span>  <span class="hljs-keyword">reg</span>                                 o_valid<span class="hljs-operator">,</span></code>
<code id="27">    <span class="hljs-keyword">output</span>  <span class="hljs-keyword">wire</span>                                o_ready</code>
<code id="28"><span class="hljs-operator">)</span><span class="hljs-operator">;</span></code>
<code id="29">    <span class="hljs-comment">// to aid understanding</span></code>
<code id="30">    <span class="hljs-keyword">localparam</span> <span class="hljs-const">TAG_BITS_WIDTH</span> <span class="hljs-operator">=</span> <span class="hljs-const">8</span><span class="hljs-operator">;</span></code>
<code id="31">    <span class="hljs-keyword">localparam</span> <span class="hljs-const">BLOCK_OFFSET_BITS</span> <span class="hljs-operator">=</span> <span class="hljs-const">4</span><span class="hljs-operator">;</span> </code>
<code id="32">    <span class="hljs-keyword">localparam</span> <span class="hljs-const">TAG_ARRAY_WIDTH</span> <span class="hljs-operator">=</span> <span class="hljs-const">32</span><span class="hljs-operator">;</span></code>
<code id="33">    <span class="hljs-keyword">localparam</span> <span class="hljs-const">STATUS_ARRAY_WIDTH</span> <span class="hljs-operator">=</span> <span class="hljs-const">8</span><span class="hljs-operator">;</span></code>
<code id="34">    <span class="hljs-keyword">localparam</span> <span class="hljs-const">SET_BITS_WIDTH</span> <span class="hljs-operator">=</span> <span class="hljs-const">4</span><span class="hljs-operator">;</span></code>
<code id="35"></code>
<code id="36">    <span class="hljs-keyword">localparam</span> <span class="hljs-const">NUM_BLOCKS</span> <span class="hljs-operator">=</span> <span class="hljs-const">4</span><span class="hljs-operator">;</span></code>
<code id="37"></code>
<code id="38">    <span class="hljs-keyword">localparam</span> <span class="hljs-const">USE_BIT_IDX</span>      <span class="hljs-operator">=</span> <span class="hljs-const">0</span><span class="hljs-operator">;</span> <span class="hljs-comment">// for use in understanding status_array_data</span></code>
<code id="39">    <span class="hljs-keyword">localparam</span> <span class="hljs-const">VALID_BIT_IDX</span>    <span class="hljs-operator">=</span> <span class="hljs-const">1</span><span class="hljs-operator">;</span></code>
<code id="40"></code>
<code id="41">    </code>
<code id="42">    <span class="hljs-keyword">reg</span>    <span class="hljs-operator">[</span><span class="hljs-const">TAG_ARRAY_WIDTH</span><span class="hljs-operator">-</span><span class="hljs-const">1</span><span class="hljs-operator">:</span><span class="hljs-const">0</span><span class="hljs-operator">]</span>         r_ta_data<span class="hljs-operator">;</span></code>
<code id="43"></code>
<code id="44">    <span class="hljs-keyword">assign</span> o_ready <span class="hljs-operator">=</span> <span class="hljs-operator">~</span>i_halt<span class="hljs-operator">;</span></code>
<code id="45"></code>
<code id="46">    <span class="hljs-keyword">always</span> @<span class="hljs-operator">(</span><span class="hljs-keyword">posedge</span> clk<span class="hljs-operator">,</span> <span class="hljs-keyword">negedge</span> arst_n<span class="hljs-operator">)</span> <span class="hljs-keyword">begin</span></code>
<code id="47">        <span class="hljs-keyword">if</span><span class="hljs-operator">(</span><span class="hljs-operator">~</span>arst_n<span class="hljs-operator">)</span> <span class="hljs-keyword">begin</span></code>
<code id="48">            o_tag_bits              <span class="hljs-operator">&lt;</span><span class="hljs-operator">=</span> <span class="hljs-operator">{</span><span class="hljs-const">TAG_BITS_WIDTH</span><span class="hljs-operator">{</span><span class="hljs-const">1</span>'b0<span class="hljs-operator">}</span><span class="hljs-operator">}</span><span class="hljs-operator">;</span></code>
<code id="49">            r_ta_data               <span class="hljs-operator">&lt;</span><span class="hljs-operator">=</span> <span class="hljs-operator">{</span><span class="hljs-const">TAG_ARRAY_WIDTH</span><span class="hljs-operator">{</span><span class="hljs-const">1</span>'b0<span class="hljs-operator">}</span><span class="hljs-operator">}</span><span class="hljs-operator">;</span></code>
<code id="50">            o_status_array_data     <span class="hljs-operator">&lt;</span><span class="hljs-operator">=</span> <span class="hljs-operator">{</span><span class="hljs-const">STATUS_ARRAY_WIDTH</span><span class="hljs-operator">{</span><span class="hljs-const">1</span>'b0<span class="hljs-operator">}</span><span class="hljs-operator">}</span><span class="hljs-operator">;</span></code>
<code id="51">            o_valid                 <span class="hljs-operator">&lt;</span><span class="hljs-operator">=</span> <span class="hljs-const">1</span>'b0<span class="hljs-operator">;</span></code>
<code id="52"></code>
<code id="53">            o_set_bits              <span class="hljs-operator">&lt;</span><span class="hljs-operator">=</span> <span class="hljs-operator">{</span><span class="hljs-const">SET_BITS_WIDTH</span><span class="hljs-operator">{</span><span class="hljs-const">1</span>'b0<span class="hljs-operator">}</span><span class="hljs-operator">}</span><span class="hljs-operator">;</span></code>
<code id="54">            o_block_offset_bits     <span class="hljs-operator">&lt;</span><span class="hljs-operator">=</span> <span class="hljs-operator">{</span><span class="hljs-const">BLOCK_OFFSET_BITS</span><span class="hljs-operator">{</span><span class="hljs-const">1</span>'b0<span class="hljs-operator">}</span><span class="hljs-operator">}</span><span class="hljs-operator">;</span></code>
<code id="55">        <span class="hljs-keyword">end</span></code>
<code id="56">        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span><span class="hljs-operator">(</span><span class="hljs-operator">~</span>i_halt<span class="hljs-operator">)</span> <span class="hljs-keyword">begin</span></code>
<code id="57">            o_tag_bits              <span class="hljs-operator">&lt;</span><span class="hljs-operator">=</span> i_tag_bits           <span class="hljs-operator">&amp;</span> <span class="hljs-operator">{</span><span class="hljs-const">TAG_BITS_WIDTH</span><span class="hljs-operator">{</span>i_valid <span class="hljs-operator">&amp;</span> <span class="hljs-operator">~</span>i_clear<span class="hljs-operator">}</span><span class="hljs-operator">}</span><span class="hljs-operator">;</span></code>
<code id="58">            r_ta_data               <span class="hljs-operator">&lt;</span><span class="hljs-operator">=</span> i_ta_data            <span class="hljs-operator">&amp;</span> <span class="hljs-operator">{</span><span class="hljs-const">TAG_ARRAY_WIDTH</span><span class="hljs-operator">{</span>i_valid <span class="hljs-operator">&amp;</span> <span class="hljs-operator">~</span>i_clear<span class="hljs-operator">}</span><span class="hljs-operator">}</span><span class="hljs-operator">;</span></code>
<code id="59">            o_status_array_data     <span class="hljs-operator">&lt;</span><span class="hljs-operator">=</span> i_status_array_data  <span class="hljs-operator">&amp;</span> <span class="hljs-operator">{</span><span class="hljs-const">STATUS_ARRAY_WIDTH</span><span class="hljs-operator">{</span>i_valid <span class="hljs-operator">&amp;</span> <span class="hljs-operator">~</span>i_clear<span class="hljs-operator">}</span><span class="hljs-operator">}</span><span class="hljs-operator">;</span></code>
<code id="60">            o_valid                 <span class="hljs-operator">&lt;</span><span class="hljs-operator">=</span> i_valid <span class="hljs-operator">&amp;</span> <span class="hljs-operator">~</span>i_clear<span class="hljs-operator">;</span></code>
<code id="61"></code>
<code id="62">            o_set_bits              <span class="hljs-operator">&lt;</span><span class="hljs-operator">=</span> i_set_bits           <span class="hljs-operator">&amp;</span> <span class="hljs-operator">{</span><span class="hljs-const">SET_BITS_WIDTH</span><span class="hljs-operator">{</span>i_valid <span class="hljs-operator">&amp;</span> <span class="hljs-operator">~</span>i_clear<span class="hljs-operator">}</span><span class="hljs-operator">}</span><span class="hljs-operator">;</span></code>
<code id="63">            o_block_offset_bits     <span class="hljs-operator">&lt;</span><span class="hljs-operator">=</span> i_block_offset_bits  <span class="hljs-operator">&amp;</span> <span class="hljs-operator">{</span><span class="hljs-const">BLOCK_OFFSET_BITS</span><span class="hljs-operator">{</span>i_valid <span class="hljs-operator">&amp;</span> <span class="hljs-operator">~</span>i_clear<span class="hljs-operator">}</span><span class="hljs-operator">}</span><span class="hljs-operator">;</span></code>
<code id="64">        <span class="hljs-keyword">end</span></code>
<code id="65">    <span class="hljs-keyword">end</span></code>
<code id="66"></code>
<code id="67">    <span class="hljs-keyword">assign</span> o_hit_blocks <span class="hljs-operator">=</span> <span class="hljs-operator">{</span></code>
<code id="68">        <span class="hljs-operator">(</span>o_tag_bits <span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span> r_ta_data<span class="hljs-operator">[</span><span class="hljs-const">24</span> +<span class="hljs-operator">:</span> <span class="hljs-const">TAG_BITS_WIDTH</span><span class="hljs-operator">]</span><span class="hljs-operator">)</span> <span class="hljs-operator">&amp;</span> o_status_array_data<span class="hljs-operator">[</span><span class="hljs-const">6</span><span class="hljs-operator">]</span><span class="hljs-operator">,</span></code>
<code id="69">        <span class="hljs-operator">(</span>o_tag_bits <span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span> r_ta_data<span class="hljs-operator">[</span><span class="hljs-const">16</span> +<span class="hljs-operator">:</span> <span class="hljs-const">TAG_BITS_WIDTH</span><span class="hljs-operator">]</span><span class="hljs-operator">)</span> <span class="hljs-operator">&amp;</span> o_status_array_data<span class="hljs-operator">[</span><span class="hljs-const">4</span><span class="hljs-operator">]</span><span class="hljs-operator">,</span></code>
<code id="70">        <span class="hljs-operator">(</span>o_tag_bits <span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span> r_ta_data<span class="hljs-operator">[</span><span class="hljs-const">8</span>  +<span class="hljs-operator">:</span> <span class="hljs-const">TAG_BITS_WIDTH</span><span class="hljs-operator">]</span><span class="hljs-operator">)</span> <span class="hljs-operator">&amp;</span> o_status_array_data<span class="hljs-operator">[</span><span class="hljs-const">2</span><span class="hljs-operator">]</span><span class="hljs-operator">,</span></code>
<code id="71">        <span class="hljs-operator">(</span>o_tag_bits <span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span> r_ta_data<span class="hljs-operator">[</span><span class="hljs-const">0</span>  +<span class="hljs-operator">:</span> <span class="hljs-const">TAG_BITS_WIDTH</span><span class="hljs-operator">]</span><span class="hljs-operator">)</span> <span class="hljs-operator">&amp;</span> o_status_array_data<span class="hljs-operator">[</span><span class="hljs-const">0</span><span class="hljs-operator">]</span></code>
<code id="72">    <span class="hljs-operator">}</span> <span class="hljs-operator">&amp;</span> <span class="hljs-operator">{</span><span class="hljs-const">NUM_BLOCKS</span><span class="hljs-operator">{</span>o_valid<span class="hljs-operator">}</span><span class="hljs-operator">}</span><span class="hljs-operator">;</span></code>
<code id="73"></code>
<code id="74">    <span class="hljs-keyword">assign</span> o_cache_hit <span class="hljs-operator">=</span> <span class="hljs-operator">|</span>o_hit_blocks<span class="hljs-operator">;</span></code>
<code id="75"></code>
<code id="76"><span class="hljs-keyword">endmodule</span></code>
</pre>
  </body>
</html>